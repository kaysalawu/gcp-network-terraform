apiVersion: skaffold/v2beta8
kind: Config
profiles:
  - name: tools
    build:
      local:
        push: false
    deploy:
      kustomize:
        paths:
          - tools/manifests/kustomize/base
  - name: endpoints
    build:
      tagPolicy:
        envTemplate:
          template: "{{.VERSION}}"
      artifacts:
        - image: europe-west2-docker.pkg.dev/prj-hub-lab/g5-hub-eu-repo/endpoints
          context: discovery/endpoints/app
          docker:
            dockerfile: Dockerfile
    deploy:
      kustomize:
        paths:
          - discovery/endpoints/manifests/kustomize/base
          - discovery/endpoints/manifests/kustomize/overlays
  - name: operator
    build:
      tagPolicy:
        envTemplate:
          template: "{{.VERSION}}"
      artifacts:
        - image: europe-west2-docker.pkg.dev/prj-hub-lab/g5-hub-eu-repo/discovery-operator
          context: discovery/operator/app
          docker:
            dockerfile: Dockerfile
    deploy:
      kustomize:
        paths:
          - discovery/operator/manifests/kustomize/base
  - name: api-server
    build:
      tagPolicy:
        envTemplate:
          template: "{{.VERSION}}"
      artifacts:
        - image: europe-west2-docker.pkg.dev/prj-hub-lab/g5-hub-eu-repo/api-server
          context: discovery/api-server/app
          docker:
            dockerfile: Dockerfile
    deploy:
      kustomize:
        paths:
          - discovery/api-server/manifests/kustomize/base
          - discovery/api-server/manifests/kustomize/overlays/load-balancers
  - name: orchestras
    deploy:
      kustomize:
        paths:
          - discovery/orchestras/manifests/kustomize/base
